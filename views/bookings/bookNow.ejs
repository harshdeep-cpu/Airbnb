<%- include('../partials/head')%>
  </head>

  <body class="bg-gradient-to-r from-pink-50 to-red-100 font-sans">

    <!-- Navbar (optional) -->
    <!-- <%- include('../partials/nav')%> -->

    <main class="container mx-auto mt-12 p-10 bg-white rounded-2xl shadow-2xl max-w-5xl">
      <!-- Title -->
      <h1 class="text-4xl font-extrabold mb-10 text-center text-red-600 tracking-wide">
        Book <%= home.houseName %>
      </h1>

      <!-- Home Info Card -->
      <div class="grid md:grid-cols-2 gap-8 mb-12">
        <div class="rounded-xl overflow-hidden shadow-lg">
          <img src="<%= home.photo %>" alt="<%= home.houseName %>"
            class="w-full h-64 object-cover hover:scale-105 transition duration-300" />
        </div>
        <div class="flex flex-col justify-center space-y-4">
          <h2 class="text-2xl font-bold text-gray-800">
            <%= home.houseName %>
          </h2>
          <p class="text-lg text-gray-600"><span class="font-semibold">Location:</span>
            <%= home.location %>
          </p>
          <p class="text-lg text-gray-600"><span class="font-semibold">Price:</span> ₹<%= home.price %> / night</p>
          <p class="text-lg text-gray-600"><span class="font-semibold">Rating:</span>
            <%= home.rating %> ⭐
          </p>
        </div>
      </div>

      <!-- Booking Form -->
      <form id="payment-form" enctype="multipart/form-data" class="bg-gray-50 p-8 rounded-xl shadow-md space-y-6">
        <h2 class="text-2xl font-semibold text-gray-700 mb-6 border-b pb-2">Guest Details</h2>

        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <label class="block text-gray-700 font-medium mb-1">Name</label>
            <input type="text" name="guestName" placeholder="Enter your name"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500" />
          </div>

          <div>
            <label class="block text-gray-700 font-medium mb-1">Email</label>
            <input type="email" name="guestmail" placeholder="Enter your email"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500" />
          </div>

          <div>
            <label class="block text-gray-700 font-medium mb-1">Phone Number</label>
            <input type="number" name="guestPhoneNo" placeholder="Enter your phone no."
              class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500" />
          </div>
          <div>
            <label class="block text-gray-700 font-medium mb-1">No of Guest</label>
            <input type="number" name="guestNo" placeholder="Enter Guest count"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500" />
          </div>
        </div>

        <!-- Check-in & Check-out same line -->
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <label class="block text-gray-700 font-medium mb-1">Check-in Date</label>
            <input type="date" name="checkinDate"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500" />
          </div>
          <div>
            <label class="block text-gray-700 font-medium mb-1">Check-out Date</label>
            <input type="date" name="checkoutDate"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500" />
          </div>
        </div>

        <input type="hidden" id="homeId" name="homeId" value="<%= home._id %>">

        <!-- Submit Button -->
        <div class="pt-4">
          <button type="submit" id="pay-btn"
            class="w-full py-3 bg-gradient-to-r from-red-500 to-pink-500 text-white font-bold rounded-lg shadow-lg hover:scale-[1.02] hover:shadow-xl transition duration-300">
            Proceed to Payment
          </button>
        </div>
      </form>
    </main>
    <!-- Razorpay checkout script -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
      document.getElementById("pay-btn").addEventListener("click", async function (e) {
        e.preventDefault();

        const homeId = "<%= home._id %>";
        const response = await fetch("/createOrder", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ homeId })
        });

        const data = await response.json();
        if (!data.success) {
          alert("Failed to create order");
          return;
        }

        const { order } = data;
        const options = {
          key: "<%= process.env.RAZORPAY_KEY_ID %>",
          amount: order.amount,
          currency: order.currency,
          order_id: order.id,
          name: "Airbnb Clone",
          description: "Booking Payment",
          handler: async function (response) {
            // verify route
            await fetch("/verifyPayemtn", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(response)
            });
            alert("Payment successful!");
          }
        };

        const rzp = new Razorpay(options);
        rzp.open();
      });
    </script>

  </body>

  </html>